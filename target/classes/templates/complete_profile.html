<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Signup Clone</title>
    <!-- Add Cropper.js CSS file -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
    <style>
        body {
           margin: 0;
           height: 100vh;
           display: flex;
           justify-content: center;
           align-items: center;
           background: url('https://source.unsplash.com/1600x900/?nature,sky') no-repeat center center/cover;
           font-family: Arial, sans-serif;
       }

       .signup-box {
           background-color: white;
           padding: 20px;
           width: 350px;
           box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
           border-radius: 8px;
           text-align: left;
       }

       .signup-box h2 {
           font-size: 22px;
           font-weight: bold;
           margin-bottom: 10px;
           color: #333;
       }

       .signup-box p {
           font-size: 14px;
           color: #666;
           margin-bottom: 15px;
       }

       .signup-box input {
           width: calc(100% - 20px);
           padding: 8px;
           margin-top: 6px;
           border: 1px solid #ccc;
           border-radius: 5px;
           font-size: 14px;
           display: block;
           margin-left: auto;
           margin-right: auto;
           box-sizing: border-box;
       }

       .signup-box button {
           width: 100%;
           padding: 10px;
           background-color: #0073b1;
           color: white;
           border: none;
           border-radius: 5px;
           font-size: 14px;
           cursor: pointer;
           margin-top: 12px;
           font-weight: bold;
       }

       .signup-box button:hover {
           background-color: #005582;
       }

       .profile-pic-container {
           text-align: center;
           margin-bottom: 12px;
       }

       .profile-pic {
           width: 140px;
           height: 140px;
           border-radius: 50%;
           object-fit: cover;
           border: 2px solid #ccc;
           background-color: #f0f0f0;
       }

       .upload-link {
           display: block;
           font-size: 12px;
           color: #0073b1;
           text-decoration: none;
           font-weight: bold;
           margin-top: 5px;
           cursor: pointer;
       }

       #upload {
           display: none; /* Hide the default file input */
       }

       /* Modal Styles */
       .modal {
           display: none;
           position: fixed;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           background: rgba(0, 0, 0, 0.7);
           justify-content: center;
           align-items: center;
           z-index: 1000;
       }

       .modal-content{
           background: white;
           padding: 20px;
           border-radius: 10px;
           width: 80%;
           max-width: 400px;
           text-align: center;
       }

       .image-container {
           height: 300px;
           max-width: 100%;
           margin: 0 auto 15px;
       }

       .modal-buttons {
           margin-top: 15px;
       }

       .modal-buttons button {
           padding: 8px 12px;
           margin: 5px;
           border: none;
           border-radius: 5px;
           cursor: pointer;
       }

       .btn-crop {
           background: #0073b1;
           color: white;
       }

       .btn-cancel {
           background: #ccc;
       }
       .logo  img{
         height:60px;
        }
    </style>
</head>
<body>

<div class="signup-box">
    <div class="logo">
        <img src="data:image/png;base64,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" alt="LinkedIn Logo"/>
    </div>

    <form th:action="@{/userDetails}" th:object="${userDTO}" method="post" enctype="multipart/form-data">
        <div class="profile-pic-container">
            <img id="profile-pic" class="profile-pic" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=" alt="Profile Picture">
            <input type="file" id="upload" name="profileImage" accept="image/*" required>
            <a class="upload-link" onclick="document.getElementById('upload').click();">Upload profile</a>
        </div>

        <input type="text" th:field="*{firstName}" placeholder="First Name" required>
        <input type="text" th:field="*{lastName}" placeholder="Last Name" required>
        <input type="text" th:field="*{location.city}" placeholder="Location" required>
        <button type="submit">Next</button>
    </form>
</div>

<div id="crop-modal" class="modal">
    <div class="modal-content">
        <h3>Adjust Your Profile Picture</h3>
        <div class="image-container">
            <img id="crop-image" style="max-width: 100%;">
        </div>
        <div class="modal-buttons">
            <button class="btn-crop" onclick="applyCrop()">Apply</button>
            <button class="btn-cancel" onclick="closeModal()">Cancel</button>
        </div>
    </div>
</div>

<!-- Include Cropper.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
<script>
    let cropper;
    let selectedFile;

    document.getElementById('upload').addEventListener('change', function(event) {
        selectedFile = event.target.files[0];

        if (selectedFile) {
            let reader = new FileReader();
            reader.onload = function(e) {
                let cropImage = document.getElementById('crop-image');
                cropImage.src = e.target.result;

                // Open modal after image is loaded
                setTimeout(openModal, 100);
            };
            reader.readAsDataURL(selectedFile);
        }
    });

    function openModal() {
        let modal = document.getElementById('crop-modal');
        modal.style.display = 'flex';

        let image = document.getElementById('crop-image');

        // Destroy previous Cropper instance if exists
        if (cropper) {
            cropper.destroy();
        }

        // Initialize Cropper
        cropper = new Cropper(image, {
            aspectRatio: 1,
            viewMode: 1,
            background: false,
            autoCropArea: 0.8,
            responsive: true,
            ready: function() {
                // Ensure the cropper is properly initialized
                this.cropper.crop();
            }
        });
    }

    function applyCrop() {
        if (!cropper) return;

        // Get the cropped canvas
        let canvas = cropper.getCroppedCanvas({
            width: 140,
            height: 140
        });

        // Update the profile picture preview
        document.getElementById('profile-pic').src = canvas.toDataURL();

        // Convert canvas to blob for form submission
        canvas.toBlob(function(blob) {
            // Create a new File object
            let file = new File([blob], "profile.png", { type: "image/png" });

            // Update the file input
            const dataTransfer = new DataTransfer();
            dataTransfer.items.add(file);
            document.getElementById('upload').files = dataTransfer.files;
        });

        // Close the modal
        closeModal();
    }

    function closeModal() {
        let modal = document.getElementById('crop-modal');
        modal.style.display = 'none';

        if (cropper) {
            cropper.destroy();
            cropper = null;
        }
    }
</script>
</body>
</html>